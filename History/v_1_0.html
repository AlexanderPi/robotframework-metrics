<body style="padding: 5px">
 <h1 style="font-size: 2em;">
  Robot Framework Metrics Report
 </h1>
 <br/>
 <button class="tablink" id="defaultOpen" onclick="openPage('dashboard', this, 'orange');">
  Dashboard
 </button>
 <button class="tablink" onclick="openPage('testMetrics', this, 'orange');executeDataTable('#tm',4)">
  Test Metrics
 </button>
 <button class="tablink" onclick="openPage('keywordMetrics', this, 'orange');executeDataTable('#km',5)">
  Keyword Metrics
 </button>
 <div class="tabcontent" id="keywordMetrics">
  <br/>
  <br/>
  <table class="table table-striped table-bordered" id="km" style="padding: 5px;font-size: 13px;">
   <thead>
    <tr>
     <th>
      Test Case
     </th>
     <th>
      Keyword
     </th>
     <th>
      Status
     </th>
     <th>
      Start Time
     </th>
     <th>
      End time
     </th>
     <th>
      Elapsed Time
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-001
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Launch Chrome Browser
     </td>
     <td>
      FAIL
     </td>
     <td>
      20180729 18:03:58.891
     </td>
     <td>
      20180729 18:04:08.841
     </td>
     <td>
      00:00:09.950
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-003
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Enter Password
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:05:09.141
     </td>
     <td>
      20180729 18:05:09.347
     </td>
     <td>
      00:00:00.206
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-003
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Enter Email Or Phone
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:03:03.141
     </td>
     <td>
      20180729 18:05:09.141
     </td>
     <td>
      00:02:06
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-003
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Go To Facebook Login
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:46.250
     </td>
     <td>
      20180729 18:04:48.865
     </td>
     <td>
      00:00:02.615
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-003
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Launch Chrome Browser
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:38.198
     </td>
     <td>
      20180729 18:04:46.249
     </td>
     <td>
      00:00:08.051
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-002
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Enter Password
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:37.986
     </td>
     <td>
      20180729 18:04:38.193
     </td>
     <td>
      00:00:00.207
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-002
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Enter Email Or Phone
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:27.683
     </td>
     <td>
      20180729 18:04:37.985
     </td>
     <td>
      00:00:10.302
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-002
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Go To Facebook Login
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:25.215
     </td>
     <td>
      20180729 18:04:27.683
     </td>
     <td>
      00:00:02.468
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-002
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Launch Chrome Browser
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:16.829
     </td>
     <td>
      20180729 18:04:25.215
     </td>
     <td>
      00:00:08.386
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-001
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Enter Password
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:16.616
     </td>
     <td>
      20180729 18:04:16.826
     </td>
     <td>
      00:00:00.210
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-001
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Enter Email Or Phone
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:11.291
     </td>
     <td>
      20180729 18:04:16.615
     </td>
     <td>
      00:00:05.324
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-001
     </td>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      Go To Facebook Login
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:08.842
     </td>
     <td>
      20180729 18:04:11.290
     </td>
     <td>
      00:00:02.448
     </td>
    </tr>
   </tbody>
  </table>
 </div>
 <div class="tabcontent" id="dashboard">
  <br/>
  <div id="containers">
   <div class="block">
    <button onclick="createPieChart('#tm',1,'testChartID','Tests Status:')" style="align: center;width:100%">
     &lt;&lt;&lt;&lt; Click Here For Tests Status Chart &gt;&gt;&gt;&gt;
    </button>
    <div id="testChartID" style="height: 300px; width: 100%;">
    </div>
   </div>
   <div class="block">
    <button onclick="executeDataTable('#tm',4);createBarGraph('#tm',0,4,10,'testsBarID','Top 10 Tests Performance:')" style="align: center;width:100%">
     &lt;&lt;&lt;&lt; Click Here For Tests Performace Chart &gt;&gt;&gt;&gt;
    </button>
    <div id="testsBarID" style="height: 300px; width: 100%;">
    </div>
   </div>
   <div class="block">
    <button onclick="createPieChart('#km',2,'keywordChartID','Keywords Status:')" style="align: center;width:100%">
     &lt;&lt;&lt;&lt; Click Here For Keywords Status Chart &gt;&gt;&gt;&gt;
    </button>
    <div id="keywordChartID" style="height: 300px; width: 100%;">
    </div>
   </div>
   <div class="block">
    <button onclick="executeDataTable('#km',5);createBarGraph('#km',1,5,10,'keywordsBarID','Top 10 Keywords Performance:')" style="align: center;width:100%">
     &lt;&lt;&lt;&lt; Click Here For Keyword Performance Chart &gt;&gt;&gt;&gt;
    </button>
    <div id="keywordsBarID" style="height: 300px; width: 100%;">
    </div>
   </div>
  </div>
 </div>
 <script>
  function createPieChart(tableID,status_column,ChartID,ChartName){

var chart = new CanvasJS.Chart(ChartID,{  
    exportFileName: ChartName,
	exportEnabled: true,	
    animationEnabled: true,
	title: {
    text: ChartName,
    fontFamily: "Comic Sans MS",
    fontSize: 15,
	horizontalAlign: "left",
    
  },
  data: []
  
});

var rows = $(tableID).dataTable().fnGetNodes();
var columns;
var isPass = 0;
var isFail = 0;

for (var i = 0; i < rows.length; i++) {
  columns = $(rows[i]).find('td');  
  
    if (columns[Number(status_column)].innerHTML.trim() == "PASS") {
      isPass = isPass + 1;      
    } else {
      isFail = isFail + 1;      
    }
  }  
var status = [{label:'PASS',y:parseInt(isPass),color:"Green"},{label:'FAIL',y:parseInt(isFail),color:"Red"}];
  chart.options.data.push({
    //type: "pie",
    type: "doughnut",
    startAngle: 60,
    //innerRadius: 60,
    indexLabelFontSize: 15,
    indexLabel: "{label} - #percent%",
    toolTipContent: "<b>{label}:</b> {y} (#percent%)",

    //name: ($(columns[0]).html()), 
    //showInLegend: true,
    //legendText: ($(columns[0]).html()),
    dataPoints: status
  });
  chart.render();
}
 </script>
 <script>
  function createBarGraph(tableID,keyword_column,time_column,limit,ChartID,ChartName){
      var chart = new CanvasJS.Chart(ChartID, {
       exportFileName: ChartName,
        exportEnabled: true,	
        animationEnabled: true,
    title: {
        text: ChartName,
        fontFamily: "Comic Sans MS",
        fontSize: 15,
        textAlign: "centre",
        dockInsidePlotArea: true,
    },
      axisX:{
        //title:"Axis X title",
        labelAngle: 0,
        labelFontSize: 10,
        labelFontFamily:"Comic Sans MS",
        
      },
      axisY:{
        title:"Seconds (s)",
      },
      data: []
    });

var status = [];
css_selector_locator = tableID + ' tbody >tr'
var rows = $(css_selector_locator);
var columns;

for (var i = 0; i < rows.length; i++) {
    if (i == Number(limit)){
        break;
    }
	//status = [];
  name_value = $(rows[i]).find('td'); 
  
  time=($(name_value[Number(time_column)]).html()).trim();
    try {
	    mfree=time.split(".")    
        if (mfree.length > 1){
            tt=mfree[0].split(":");
            sec=tt[0]*3600+tt[1]*60+tt[2]*1+(mfree[1]/1000)*1;
        } else {
            tt=mfree[0].split(":");
            sec=tt[0]*3600+tt[1]*60+tt[2]*1;
        }
	    
    }
        catch (e) {
	    tt=time.split(":");
	    sec=tt[0]*3600+tt[1]*60+tt[2]*1;
    }
	
	status.push({label:$(name_value[Number(keyword_column)]).html(),y:sec});
  }  
	chart.options.data.push({
    type: "column",
    //name: ($(rows[0]).find('th')), 
    //showInLegend: true,
    //legendText: ($(rows[0]).find('th')),
	//yValueFormatString: "HH-mm-ss.fff",
    indexLabel: "{y} s",
    toolTipContent: "<b>{label}:</b> {y} s",
    dataPoints: status
  });
  
    chart.render();
	}
  </script>
 </script>
 <script>
  function executeDataTable(tabname,sortCol) {
    $(tabname).DataTable(
        {
        retrieve: true,
        "order": [[ Number(sortCol), "desc" ]]
        } 
    );
}
 </script>
 <script>
  function openPage(pageName,elmnt,color) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablink");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].style.backgroundColor = "";
    }
    document.getElementById(pageName).style.display = "block";
    elmnt.style.backgroundColor = color;

}
// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
 </script>
 <div class="tabcontent" id="testMetrics">
  <br/>
  <br/>
  <table class="table table-striped table-bordered" id="tm" style="padding: 5px;font-size: 13px;">
   <thead>
    <tr>
     <th>
      Test Case
     </th>
     <th>
      Status
     </th>
     <th>
      Start Time
     </th>
     <th>
      End time
     </th>
     <th>
      Elapsed Time
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-003
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:38.196
     </td>
     <td>
      20180729 18:05:09.348
     </td>
     <td>
      00:00:31.152
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-002
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:04:16.829
     </td>
     <td>
      20180729 18:04:17.829
     </td>
     <td>
      00:00:01
     </td>
    </tr>
    <tr>
     <td style="word-wrap: break-word;max-width: 200px; white-space: normal">
      TC-001
     </td>
     <td>
      PASS
     </td>
     <td>
      20180729 18:03:58.891
     </td>
     <td>
      20180729 18:04:16.827
     </td>
     <td>
      00:00:17.936
     </td>
    </tr>
   </tbody>
  </table>
 </div>
</body>
<!DOCTYPE html>
<html>
 <head>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Robot Framework Metrics Report
  </title>
  <meta charset="utf-8">
   <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
   <link href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" rel="stylesheet" type="text/css"/>
   <script src="https://code.jquery.com/jquery-3.3.1.js" type="text/javascript">
   </script>
   <script src="https://canvasjs.com/assets/script/canvasjs.min.js">
   </script>
   <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js" type="text/javascript">
   </script>
   <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js" type="text/javascript">
   </script>
   <style>
    * {box-sizing: border-box}

/* Set height of body and the document to 100% */
body, html {
    height: 100%;
    margin: 0;
    font-family:  Comic Sans MS;
}


/* Style tab links */
.tablink {
    background-color: #555;
    color: white;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    font-size: 14px;
    width: 33.3%;
}

.tablink:hover {
    background-color: #777;
}

/* Style the tab content (and add height:100% for full page content) */
.tabcontent {
    color: black;
    display: none;
    padding: 15px;
    height: 100%;
}

#container {
  text-align: center;
  max-width: 45%;
  //height: 100%
  margin: 0 auto;
}
.block {
  width: 45%;
  height: 320px;
  margin: 20px;
  display: inline-block;
  background: #f1f1f1;
}

#dashboard {background-color: white;}
#testMetrics {background-color: white;}
#keywordMetrics {background-color: white;}
   </style>
  </meta>
 </head>
</html>
